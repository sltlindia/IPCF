<!-- created by : Akash Ramani;
      Creation Date : 10-07-2017;
-->


<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>



<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IPCF</title>
<link rel="icon" href="ipcf/img/sltenergy.png" type="image/x-icon">
<link rel="stylesheet" href="ipcf/css/bootstrap1.min.css">
<script src="ipcf/js/jquery.min.js"></script>
<script src="ipcf/js/bootstrap.min.js"></script>

<script src="ipcf/js/anychart-bundle.min.js"></script>
<link rel="stylesheet" href="ipcf/css/anychart-ui.min.css" />


<style type="text/css">



@media print {

   .breaker {page-break-before: always;}
    body {-webkit-print-color-adjust: exact;}
    
}


@media print {
@page { size : landscape }
   @page rotated { size : landscape }
}

@media print { 
    .table td .mainTD { 
        background-color:#F5CBA7 !important; 
    } 
    .table td .childTD { 
        background-color:#ABEBC6 !important; 
    } 
    
    
     .table th { 
        background-color:#F5CBA7 !important; 
    }
    
}




input[type=text] {
	padding: 5px 0px 0px 5px;
	font-size: 10px;
}

select {
	width: 100%;
	padding: 5px 0px 0px 5px;
}

.form-control {
	height: 22px;
	font-size: 8px;
	font-weight: bold;
}

body {
	font-size: 11px;
	font-style: Calibri;
	padding: 10px 0 0 10px;
}

table>tr>td, .table>tr>th {
	padding: 2px 2px 2px 2px;
	line-height: 1.42857143;
	vertical-align: top;
	border-top: 1px solid #ddd;
}

.mainTr{
	background-color:#F5CBA7 !important;
}
#cumulativeCashFlow, #netCashFlow {
             width: 100%;
             height: 100%;
             margin: 0;
             padding: 0;
         }
         
</style>

<script type="text/javascript">
</script>

<script type="text/javascript">



function PopUp()
{
	
        document.getElementById('#modal').style.display="show"; 
}

function login()
{
	/* var PWD = document.getElementById("PWD").value;
	window.location.replace("UpdateValue?PWD="+PWD+""); */
	 document.getElementById("UpdateValue").submit();
}

</script>
</head>
<body>
<div id="content">
<form action="#">
<img src="ipcf/img/sltenergy.png" height="60px" width="120px">
<br>
	<table class="table">

		<tr>

			<td>

				<table>

					<tr>
						<td>

									<table class="table table-bordered">
										
										<tr bgcolor="#F5CBA7">
											<td class="mainTD" colspan="2" align="center"><b>TECHNICAL PARAMETERS</b></td>
										</tr>
										
										<tr>
											<td>Hot Water/Oil Kg Per Hour</td>
											<td id="B10_1">
													
											
										</td>
										</tr>
										<tr>
											<td>Inlet Temp</td>
											<td id="B11_1"> 
											
											</td>
										</tr>
										<tr>
											<td>Outlet Temp</td>
											<td id="B12_1">
											
											</td>
										</tr>
										<tr>
											<td>Delt T</td>
											<td id="B13_1">
											 
											</td>
										</tr>
										<tr>
											<td>Fluid</td>
											<td id="B14_1">
											
											</td>
										</tr>
										<tr>
											<td>Specific Heat(j)</td>
											<td id="B15_1">
											 
											</td>
										</tr>
										<tr>
											<td>Kilo Watts per collector</td>
											<td id="B16_1">
											 
											</td>
										</tr>
										<tr>
											<td>Requierd Kilo Watts || KJ/Sec</td>
											<td id="B17_1">
											
											</td>
										</tr>
										<tr>
											<td>Collector Required</td>
											<td id="B18_1">
											 
											</td>
										</tr>
										<tr>
											<td>M/2 area required for one collector</td>
											<td id="B19_1">
											
											</td>
										</tr>
										<tr>
											<td>Required area in M/2</td>
											<td id="B20_1">
											
											</td>
										</tr>
										<tr>
											<td>Floor area per collector</td>
											<td id="B21_1">
											 
											</td>
										</tr>
										<tr>
											<td>Required Floor area</td>
											<td id="B22_1">
											 
											</td>
										</tr>
										<tr>
											<td>Charges per collector</td>
											<td id="B23_1">
											 
											</td>
										</tr>
										<tr>
											<td>Heat Exchanger,Piping,Fitting,Control
												Panel,Pump,Manual Valves(Rs.)</td>
											<td id="B24_1">
											 
											</td>
										</tr>
										<tr>
											<td>Cost to client</td>
											<td id="B25_1">
											</td>
										</tr>
										<tr>
											<td>Additional expenses to client(civil work,etc)(Rs.)</td>
											<td id="B26_1">
											</td>
										</tr>
										<tr>
											<td>Total cost(Rs.)</td>
											<td id="B27_1">
												</td>
										</tr>
										<tr>
											<td>Subusidy. 30%(Rs.)</td>
											<td id="B28_1">
											</td>
										</tr>
										<tr>
											<td>Sububsidy as per area (Rs.)</td>
											<td id="B29_1">
												</td>
										</tr>
										<tr>
											<td>Net Cost of System(Rs.)</td>
											<td id="B30_1">
												</td>
										</tr>

									</table>

						</td>
					</tr>

				</table>
			</td>

			<td style="padding-left: 10px;padding-right: 10px;">



				<table class="table table-bordered" >
					
					<tr bgcolor="#F5CBA7">
						<td align="center" class="mainTD"><b>FINANCIAL FEASIBILITY ANALYSIS</b></td>
					</tr>
					
					<tr>
						<td>




									<div class="row">

										<div class="col-md-6 col-sm-6 col-xs-6">


													<table class="table table-bordered">
													
														
														<tr bgcolor="#ABEBC6">
															<td colspan="2" align="center" class="childTD"><b>INVESTMENT</b></td>
														</tr>
													
													
														<tr>
															<td><u><b>PARTICULARS</b></u></td>
															<td><u><b>AMOUNT(RS)</b></u></td>
														</tr>


														<tr>
															<td>COST OF SYSTEM</td>
															<td id="B11_2">
																</td>
														</tr>
														<tr>
															<td>Less:- MNRE SUBSIDY</td>
															<td id="B12_2">
																</td>
														</tr>
														<tr>
															<td align="right"><b>NET COST OF SYSTEM</b></td>
															<td id="B13_2">
																</td>
														</tr>
														<tr>
															<td colspan="2"><b>ANNUAL MAINTANANCE CONTRACT</b></td>
														</tr>
														<tr>
															<td>AMC FROM 2nd YEAR</td>
															<td id="B16_2">
																</td>
														</tr>
														<tr>
															<td>AMC FROM 5th YEAR Onwards</td>
															<td id="B17_2">
																</td>
														</tr>

														<tr>
															<td colspan="2"><b>REPLACEMENT OF REFLECTOR </b></td>
														</tr>
														<tr>
															<td>Parabolic trough reflector every 7 year</td>
															<td id="B20_2">
																</td>
														</tr>

														<tr>
															<td colspan="2"><b>YEARLY OPERATING COST </b></td>
														</tr>
														<tr>
															<td>Salary of man power (Per year)</td>
															<td id="B23_2">
																</td>
														</tr>
														<tr>
															<td>Parasitic Electricity consumption</td>
															<td id="B24_2">
															</td>
														</tr>
													</table>




													<table class="table table-bordered">

														<tr bgcolor="#ABEBC6">
															<td colspan="2" class="childTD">
															<div class="row">
																<div class="col-md-6 col-sm-6 col-xs-6">
																	<b>SAVING</b>
																</div>
																
																<div class="col-md-6 col-sm-6 col-xs-6" align="right" id="B26_2">
																</div>
															</div>
															</td>
															
														</tr>

														<tr>
															<td>Fuel Net Calorific Value (kcal/unit)</td>
															<td id="B27_2">
															</td>
														</tr>
														<tr>
															<td>Combustion efficiency</td>
															<td id="B28_2">
															</td>
														</tr>

														<tr>
															<td>Fuel required per day (units)</td>
															<td id="B29_2">
														</td>
														</tr>
														<tr>
															<td>Fuel price per unit (Rs./unit)</td>
															<td id="B30_2">
															</td>
														</tr>


														<tr>
															<td>Expected increse in Fuel price / pa</td>
															<td id="B31_2">
															</td>
														</tr>

														<tr>
															<td>Total cost of fuel per day (Rs.)</td>
															<td id="B32_2">
															</td>
														</tr>
														<tr>
															<td>Total cost of fuel per Year(300days) (Rs.)</td>
															<td id="B33_2">
															</td>
														</tr>
													</table>




										</div>




										<div class="col-md-6 col-sm-6 col-xs-6">


													<table class="table table-bordered">
													
														<tr bgcolor="#ABEBC6">
															<td colspan="2" align="center" class="childTD"><b>MEANS OF FINANCE</b> 
														</tr>
													
														<tr>
															<td>EQUITY</td>
															<td id="B37_2">
															</td>
														</tr>
														<tr>
															<td>DEBT FROM BANK</td>
															<td id="B38_2">
															</td>
														</tr>

														<tr>
															<td>RATE OF INTEREST</td>
															<td id="B39_2">
															</td>
														</tr>
														<tr>
															<td>LOAN PERIOD (NO OF MONTHS)</td>
															<td id="B40_2">
															</td>
														</tr>


														<tr>
															<td>EMI PER YEAR</td>
															<td id="B41_2">
															</td>
														</tr>

													</table>




													<table class="table table-bordered">
													
														<tr bgcolor="#ABEBC6">
															<td colspan="2" align="center" class="childTD"><b>ASSUMPTIONS</b></td>
														</tr>
													
														<tr>
															<td>Depreciation (Tax benefit) for First Year</td>
															<td id="B44_2">
															</td>
														</tr>
														<tr>
															<td>Depreciation (Tax benefit) for Second Year</td>
															<td id="B45_2">
															</td>
														</tr>

														<tr>
															<td>Applicable Income Tax Slab</td>
															<td id="B46_2">
															</td>
														</tr>
														<tr>
															<td>Total tax saved for first year (in Rs.)</td>
															<td id="B47_2">
															</td>
														</tr>


														<tr>
															<td>Parasitic Electricity consumption (kWh/day)</td>
															<td id="B48_2">
															</td>
														</tr>

														<tr>
															<td>Electricity tariff (Rs./kWh)</td>
															<td id="B49_2">
															</td>
														</tr>

														<tr>
															<td>Annual parasitic consumption cost (Rs.)</td>
															<td id="B50_2">
															</td>
														</tr>

														<tr>
															<td>Rate of Inflation</td>
															<td id="B51_2">
															</td>
														</tr>

														<tr>
															<td>No of working days pa</td>
															<td id="B52_2">
															</td>
														</tr>

														<tr>
															<td>Life of system No of years</td>
															<td id="B53_2">
															 </td> 
														</tr>

													</table>



										</div>

									</div>



						</td>
					</tr>

				</table>
			</td>
		</tr>
	</table>

</form>

<div class="breaker"></div>
<br>
<div class="row">
<div class="col-md-12">
<div align="center" style="font-size: 20px;"><u><b>CASH FLOW STATEMENT FOR THE LIFE OF SYSTEM</b></u></div>
<br>
</div>	
	<div class="col-md-12">
		<table class="table table-bordered" id="cashflow" bordercolor="black">
					<tr bgcolor="#F5CBA7">
						<th class="mainTH">YEAR</th>
						<th class="mainTH">SYSTEM</th>
						<th colspan="2" class="mainTH">CASH IN FLOW</th>
						<th colspan="4" class="mainTH">CASH OUT FLOW</th>
						<th class="mainTH">NET CASH FLOW</th>
						<th class="mainTH">CUMULATIVE</th>
					</tr>
					
					<tr bgcolor="#F5CBA7">
						<th class="mainTH"></th>
						<th class="mainTH">INVESTMENT</th>
						<th class="mainTH">SAVING IN FUEL</th>
						<th class="mainTH">INCOME TAX SAVING</th>
						<th class="mainTH">OPERATING COST</th>
						<th class="mainTH">AMC</th>
						<th class="mainTH">REFLECTOR REPLACEMENT</th>
						<th class="mainTH">EMI</th>
						<th class="mainTH">PER YEAR </th>
						<th class="mainTH">CASH FLOW</th>
						
					</tr>
				</table>
	</div>
</div>	
	<div class="breaker"></div>
	<div class="col-md-12">
			<div id="netCashFlow" style="height: 350px;width: 1000px;"></div>
			 <div id="cumulativeCashFlow" style="height: 350px;width: 1000px;"></div>
	</div>




<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    Modal content
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Modal Header</h4>
      </div>
      <div class="modal-body">
      
      
      		<table class="table table-bordered" id="EMIRate" bordercolor="black">
			
			<tr>
				<td>Loan Amount : <p id="loanAmount"></p></td>
				<td>Rate Of Interest :<p id="rateOfInterest"></p></td>
				<td>Loan Period(month) :<p id="loanPeriod"></p></td>
				<td>EMI PM :<p id="emiPM"></p></td>
				<td>Per Year :<p id="perYear"></p></td>
				<td></td>
			</tr>	
			
					<tr>
						<th>Month</th>
						<th>Opening Balance</th>
						<th>Interest</th>
						<th>Principal</th>
						<th>Closing Balance</th>
						<th></th>
					</tr>
					
					
					
</table>
      
      
      
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


</div>

<div id="editor"></div>


	<script type="text/javascript">
	
	var year = [];
	var net = [];
	var cumulative = [];
	var closingBalance = [];
	
	
	
		$(document).ready(function() {

			
			 var userData = window.sessionStorage.getItem('userObject');
			 
			 
			 var response = JSON.parse(userData);
			 
			$("#B10_1").html(response.data[0].B10_1);
			$("#B11_1").html(response.data[0].B11_1);
			$("#B12_1").html(response.data[0].B12_1);
			$("#B13_1").html(response.data[0].B13_1);
			$("#B14_1").html("<b>"+response.data[0].B14_1+"<b>");
			$("#B15_1").html(response.data[0].B15_1);
			$("#B16_1").html(response.data[0].B16_1);
			$("#B17_1").html(response.data[0].B17_1);
			$("#B18_1").html(response.data[0].B18_1);
			$("#B19_1").html(response.data[0].B19_1);
			$("#B20_1").html(response.data[0].B20_1);
			$("#B21_1").html(response.data[0].B21_1);
			$("#B22_1").html(response.data[0].B22_1);
			$("#B23_1").html(response.data[0].B23_1);
			$("#B24_1").html(response.data[0].B24_1);
			$("#B25_1").html(response.data[0].B25_1);
			$("#B26_1").html(response.data[0].B26_1);
			$("#B27_1").html(response.data[0].B27_1);
			$("#B28_1").html(response.data[0].B28_1);
			$("#B29_1").html(response.data[0].B29_1);
			$("#B30_1").html(response.data[0].B30_1);
			
			$("#B11_2").html(response.data[0].B11_2);
			$("#B12_2").html(response.data[0].B12_2);
			$("#B13_2").html(response.data[0].B13_2);
			$("#B16_2").html(response.data[0].B16_2);
			$("#B17_2").html(response.data[0].B17_2);
			$("#B20_2").html(response.data[0].B20_2);
			$("#B23_2").html(response.data[0].B23_2);
			$("#B24_2").html(response.data[0].B24_2);
			$("#B26_2").html("<b>"+response.data[0].B26_2+"<b>");
			$("#B27_2").html(response.data[0].B27_2);
			$("#B28_2").html(response.data[0].B28_2);
			$("#B29_2").html(response.data[0].B29_2);
			$("#B30_2").html(response.data[0].B30_2);
			$("#B31_2").html(response.data[0].B31_2);
			$("#B32_2").html(response.data[0].B32_2);
			$("#B33_2").html(response.data[0].B33_2);
			$("#B37_2").html(response.data[0].B37_2);
			$("#B38_2").html(response.data[0].B38_2);
			$("#B39_2").html(response.data[0].B39_2);
			$("#B40_2").html(response.data[0].B40_2);
			$("#B41_2").html(response.data[0].B41_2);
			$("#B44_2").html(response.data[0].B44_2);
			$("#B45_2").html(response.data[0].B45_2);
			$("#B46_2").html(response.data[0].B46_2);
			$("#B47_2").html(response.data[0].B47_2);
			$("#B48_2").html(response.data[0].B48_2);
			$("#B49_2").html(response.data[0].B49_2);
			$("#B50_2").html(response.data[0].B50_2);
			$("#B51_2").html(response.data[0].B51_2);
			$("#B52_2").html(response.data[0].B52_2);
			$("#B53_2").html(response.data[0].B53_2);
			
			
			
			calculation();
			emiCalc();
			createCashFlow();
			netCashFlow();
			cumulativeCashFlow();
			
			setTimeout(function print(){
				window.print();
			}, 3000)
				setTimeout(function print(){
					window.close();
			}, 4000)
			

		});
		
		

		function format(id) {
			// For convert value into indian currency standard
			
			if(id != 'B26_2' && id != 'B14_1'){
				
				var x = Number($("#" + id).text().replace(/,/g , ''));
				$("#" + id).val(x.toLocaleString('en-IN'));
			
			}
			
			if(id == "B14_1"){
				var B14_1 = $("#B14_1").text();
				$("#B15_1").val(B14_1);	
			}
			
			if(id == "B26_2"){
				var B26_2 = $("#B26_2").text();
				
				var split = B26_2.split(",");
				
				
				$("#B27_2").val(split[0]);
				$("#B30_2").val(split[1]);
			}
			
		}
		
		
		function calculation(){
			//alert("test");
			
			
			var B10_1 = Number($("#B10_1").text().replace(/,/g , ''));
			var B11_1 = Number($("#B11_1").text().replace(/,/g , ''));
			var B12_1 = Number($("#B12_1").text().replace(/,/g , ''));
			var B13_1 = Number($("#B13_1").text().replace(/,/g , ''));
			var B14_1 = Number($("#B14_1").text().replace(/,/g , ''));
			var B15_1 = Number($("#B15_1").text().replace(/,/g , ''));
			var B16_1 = Number($("#B16_1").text().replace(/,/g , ''));
			var B17_1 = Number($("#B17_1").text().replace(/,/g , ''));
			var B18_1 = Number($("#B18_1").text().replace(/,/g , ''));
			var B19_1 = Number($("#B19_1").text().replace(/,/g , ''));
			var B20_1 = Number($("#B20_1").text().replace(/,/g , ''));
			var B21_1 = Number($("#B21_1").text().replace(/,/g , ''));
			var B22_1 = Number($("#B22_1").text().replace(/,/g , ''));
			var B23_1 = Number($("#B23_1").text().replace(/,/g , ''));
			var B24_1 = Number($("#B24_1").text().replace(/,/g , ''));
			var B25_1 = Number($("#B25_1").text().replace(/,/g , ''));
			var B26_1 = Number($("#B26_1").text().replace(/,/g , ''));
			var B27_1 = Number($("#B27_1").text().replace(/,/g , ''));
			var B28_1 = Number($("#B28_1").text().replace(/,/g , ''));
			var B29_1 = Number($("#B29_1").text().replace(/,/g , ''));
			var B30_1 = Number($("#B30_1").text().replace(/,/g , ''));
			
			
			var B11_2 = Number($("#B11_2").text().replace(/,/g , ''));
			var B12_2 = Number($("#B12_2").text().replace(/,/g , ''));
			var B13_2 = Number($("#B13_2").text().replace(/,/g , ''));
			var B16_2 = Number($("#B16_2").text().replace(/,/g , ''));
			var B17_2 = Number($("#B17_2").text().replace(/,/g , ''));
			var B20_2 = Number($("#B20_2").text().replace(/,/g , ''));
			var B23_2 = Number($("#B23_2").text().replace(/,/g , ''));
			var B24_2 = Number($("#B24_2").text().replace(/,/g , ''));
			var B27_2 = Number($("#B27_2").text().replace(/,/g , ''));
			var B28_2 = Number($("#B28_2").text().replace(/,/g , ''));
			var B29_2 = Number($("#B29_2").text().replace(/,/g , ''));
			var B30_2 = Number($("#B30_2").text().replace(/,/g , ''));
			var B31_2 = Number($("#B31_2").text().replace(/,/g , ''));
			var B32_2 = Number($("#B32_2").text().replace(/,/g , ''));
			var B33_2 = Number($("#B33_2").text().replace(/,/g , ''));
			var B37_2 = Number($("#B37_2").text().replace(/,/g , ''));
			var B38_2 = Number($("#B38_2").text().replace(/,/g , ''));
			var B39_2 = Number($("#B39_2").text().replace(/,/g , ''));
			var B40_2 = Number($("#B40_2").text().replace(/,/g , ''));
			var B41_2 = Number($("#B41_2").text().replace(/,/g , ''));
			var B44_2 = Number($("#B44_2").text().replace(/,/g , ''));
			var B45_2 = Number($("#B45_2").text().replace(/,/g , ''));
			var B46_2 = Number($("#B46_2").text().replace(/,/g , ''));
			var B47_2 = Number($("#B47_2").text().replace(/,/g , ''));
			var B48_2 = Number($("#B48_2").text().replace(/,/g , ''));
			var B49_2 = Number($("#B49_2").text().replace(/,/g , ''));
			var B50_2 = Number($("#B50_2").text().replace(/,/g , ''));
			var B51_2 = Number($("#B51_2").text().replace(/,/g , ''));
			var B52_2 = Number($("#B52_2").text().replace(/,/g , ''));
			var B53_2 = Number($("#B53_2").text().replace(/,/g , ''));
			
			
			//alert("test");
			
			
			
		}
	</script>
	
	
	<script type="text/javascript">
	
		function emiCalc(){
			//alert("emi");
			closingBalance = [];
			//alert("emi");
			
			var loanAmount = Number($("#B38_2").text().replace(/,/g , ''));
			var rateOfInterest = Number($("#B39_2").text().replace(/,/g , ''));
			var loanPeriod = Number($("#B40_2").text().replace(/,/g , ''));
			
			
			var r = rateOfInterest/(100*12);
			var nper = loanPeriod;
			var pv = -loanAmount;
			var fv = 0;
			
			var pmtEMI = r / (Math.pow(1 + r, nper) - 1)
            * -(pv * Math.pow(1 + r, nper) + fv);
			
			var emiPM = Math.round(pmtEMI);
			var perYear = Math.round(pmtEMI * 12); 
			
			$("#loanAmount").html(loanAmount.toLocaleString('en-IN'));
			$("#rateOfInterest").html(rateOfInterest.toLocaleString('en-IN'));
			$("#loanPeriod").html(loanPeriod.toLocaleString('en-IN'));
			$("#emiPM").html(emiPM.toLocaleString('en-IN'));
			$("#perYear").html(perYear.toLocaleString('en-IN'));
			
			var a = 0;
			var b = 0;
			var c = 0;
			var d = 0;
			var e = 0;
			
			
			for(var z=1;z<=240;z++){
				var f = 0;
				a = z;
				
				if(z==1){
					
					b = loanAmount;
					c = (b*rateOfInterest)/1200;
					d = emiPM - c;
					e = b - d
					
				}else{
					
					b = e;
					c = (b*rateOfInterest)/1200;
					d = emiPM - c;
					e = b - d; 
					if(z%12 == 0){
						f = perYear;
						closingBalance.push(e);
					}
					
				}
			$('#EMIRate > tbody:last-child').append(
		            '<tr class="emiRateTR">'// need to change closing tag to an opening `<tr>` tag.
		            +'<td id="a">'+Math.round(a).toLocaleString('en-IN')+'</td>'
		            +'<td id="b">'+Math.round(b).toLocaleString('en-IN')+'</td>'
		            +'<td id="c">'+Math.round(c).toLocaleString('en-IN')+'</td>'
		            +'<td id="d">'+Math.round(d).toLocaleString('en-IN')+'</td>'
		            +'<td id="e">'+Math.round(e).toLocaleString('en-IN')+'</td>'
		            +'<td id="f">'+Math.round(f).toLocaleString('en-IN')+'</td>'
		            +'</tr>');
			}
			//alert("emi11");
			
		}
		
	</script>
	
	
	<script type="text/javascript">
	
	
	
	function createCashFlow(){
		
		year = [];
		net = [];
		cumulative = [];
		
		
		var B10_1 = Number($("#B10_1").text().replace(/,/g , ''));
		var B11_1 = Number($("#B11_1").text().replace(/,/g , ''));
		var B12_1 = Number($("#B12_1").text().replace(/,/g , ''));
		var B13_1 = Number($("#B13_1").text().replace(/,/g , ''));
		var B14_1 = Number($("#B14_1").text().replace(/,/g , ''));
		var B15_1 = Number($("#B15_1").text().replace(/,/g , ''));
		var B16_1 = Number($("#B16_1").text().replace(/,/g , ''));
		var B17_1 = Number($("#B17_1").text().replace(/,/g , ''));
		var B18_1 = Number($("#B18_1").text().replace(/,/g , ''));
		var B19_1 = Number($("#B19_1").text().replace(/,/g , ''));
		var B20_1 = Number($("#B20_1").text().replace(/,/g , ''));
		var B21_1 = Number($("#B21_1").text().replace(/,/g , ''));
		var B22_1 = Number($("#B22_1").text().replace(/,/g , ''));
		var B23_1 = Number($("#B23_1").text().replace(/,/g , ''));
		var B24_1 = Number($("#B24_1").text().replace(/,/g , ''));
		var B25_1 = Number($("#B25_1").text().replace(/,/g , ''));
		var B26_1 = Number($("#B26_1").text().replace(/,/g , ''));
		var B27_1 = Number($("#B27_1").text().replace(/,/g , ''));
		var B28_1 = Number($("#B28_1").text().replace(/,/g , ''));
		var B29_1 = Number($("#B29_1").text().replace(/,/g , ''));
		var B30_1 = Number($("#B30_1").text().replace(/,/g , ''));
		
		
		var B11_2 = Number($("#B11_2").text().replace(/,/g , ''));
		var B12_2 = Number($("#B12_2").text().replace(/,/g , ''));
		var B13_2 = Number($("#B13_2").text().replace(/,/g , ''));
		var B16_2 = Number($("#B16_2").text().replace(/,/g , ''));
		var B17_2 = Number($("#B17_2").text().replace(/,/g , ''));
		var B20_2 = Number($("#B20_2").text().replace(/,/g , ''));
		var B23_2 = Number($("#B23_2").text().replace(/,/g , ''));
		var B24_2 = Number($("#B24_2").text().replace(/,/g , ''));
		var B27_2 = Number($("#B27_2").text().replace(/,/g , ''));
		var B28_2 = Number($("#B28_2").text().replace(/,/g , ''));
		var B29_2 = Number($("#B29_2").text().replace(/,/g , ''));
		var B30_2 = Number($("#B30_2").text().replace(/,/g , ''));
		var B31_2 = Number($("#B31_2").text().replace(/,/g , ''));
		var B32_2 = Number($("#B32_2").text().replace(/,/g , ''));
		var B33_2 = Number($("#B33_2").text().replace(/,/g , ''));
		var B37_2 = Number($("#B37_2").text().replace(/,/g , ''));
		var B38_2 = Number($("#B38_2").text().replace(/,/g , ''));
		var B39_2 = Number($("#B39_2").text().replace(/,/g , ''));
		var B40_2 = Number($("#B40_2").text().replace(/,/g , ''));
		var B41_2 = Number($("#B41_2").text().replace(/,/g , ''));
		var B44_2 = Number($("#B44_2").text().replace(/,/g , ''));
		var B45_2 = Number($("#B45_2").text().replace(/,/g , ''));
		var B46_2 = Number($("#B46_2").text().replace(/,/g , ''));
		var B47_2 = Number($("#B47_2").text().replace(/,/g , ''));
		var B48_2 = Number($("#B48_2").text().replace(/,/g , ''));
		var B49_2 = Number($("#B49_2").text().replace(/,/g , ''));
		var B50_2 = Number($("#B50_2").text().replace(/,/g , ''));
		var B51_2 = Number($("#B51_2").text().replace(/,/g , ''));
		var B52_2 = Number($("#B52_2").text().replace(/,/g , ''));
		var B53_2 = Number($("#B53_2").text().replace(/,/g , ''));
		
		
		var a = null;
		var b = null;
		var c = null;
		var d = null;
		var e = null;
		var f = null;
		var g = null;
		var i = null;
		var j = null;
		
		//alert(B53_2);
		
		for(z=0;z<=B53_2;z++){
			var h = null;
			a = z +1;
			if(z==0){
				b = B37_2;
				c = 0;
				d = 0;
				e = 0;
				f = 0;
				g = 0;
				h = 0;
				i = -b-c-e-f-g+d-h;
				j = i;
			}else if(z==1){
				b = 0;
				c = B33_2;
				d = Math.round(B13_2 * (B44_2/100) * (B46_2/100));
				e = Math.round(B23_2 + B24_2);
				f = 0;
				g = 0;
				h = 0
				
				if(closingBalance[z-1] > 0){
					h = B41_2;
				}
				
				i = Math.round(c+d-e-f-g-h);
				j = Math.round(i + j);
			}else{
				b = 0;
				c = Math.round(c + (c * (B31_2/100)));
				if(z<3){
					d = Math.round(B13_2 *((100/100)-(B44_2/100))*(B45_2/100));
				}else if(z<8){
					if(z==3){
						d = Math.round(B13_2 *(((100/100)-(B44_2/100))*0.2)*(B45_2/100));
					}else if(z==4){
						d = Math.round(B13_2 *(((100/100)-(B44_2/100))*0.2*0.2)*(B45_2/100));
					}else if(z==5){
						d = Math.round(B13_2 *(((100/100)-(B44_2/100))*0.2*0.2*0.2)*(B45_2/100));
					}else if(z==6){
						d = Math.round(B13_2 *(((100/100)-(B44_2/100))*0.2*0.2*0.2*0.2)*(B45_2/100));
					}else if(z==7){
						d = Math.round(B13_2 *(((100/100)-(B44_2/100))*0.2*0.2*0.2*0.2*0.2)*(B45_2/100));
					}
					
				}else{
					d = 0; 
				}
				e = Math.round(e + (e * (B51_2/100)));
				if(z>=2 && z<=5){
				f = B16_2;
				}else{
				f = B17_2;	
				}
				if(z==7 || z==14){
					g = B20_2;
				}else{
					g = 0;
				}
				h = 0 
				
				if(closingBalance[z-1] > 0){
					h = B41_2;
				}
				
				i = Math.round(c+d-e-f-g-h);
				j = Math.round(i + j);
			}
			
			year.push(z);
			net.push(i);
			cumulative.push(j);
			
			
			
		$('#cashflow > tbody:last-child').append(
	            '<tr class="casFlowTR">'// need to change closing tag to an opening `<tr>` tag.
	            +'<td>'+z.toLocaleString('en-IN')+'</td>'
	            +'<td>'+b.toLocaleString('en-IN')+'</td>'
	            +'<td>'+c.toLocaleString('en-IN')+'</td>'
	            +'<td>'+d.toLocaleString('en-IN')+'</td>'
	            +'<td>'+e.toLocaleString('en-IN')+'</td>'
	            +'<td>'+f.toLocaleString('en-IN')+'</td>'
	            +'<td>'+g.toLocaleString('en-IN')+'</td>'
	            +'<td>'+h.toLocaleString('en-IN')+'</td>'
	            +'<td>'+i.toLocaleString('en-IN')+'</td>'
	            +'<td>'+j.toLocaleString('en-IN')+'</td>'
	            +'</tr>');
		}

		
		
	}
	
	
	function netCashFlow(){
		
		$("#netCashFlow").empty();
		
		
		// create data set on our data
	    var dataSet = anychart.data.set(getDataNetCashFlow());

	    // map data for the first series, take x from the zero column and value from the first column of data set
	    var seriesData_1 = dataSet.mapAs({x: [0], value: [1]});

	    // map data for the second series, take x from the zero column and value from the second column of data set
	    var seriesData_2 = dataSet.mapAs({x: [0], value: [2]});

	    // map data for the third series, take x from the zero column and value from the third column of data set
	    var seriesData_3 = dataSet.mapAs({x: [0], value: [3]});

	    // create line chart
	    chart = anychart.line();

	    // turn on chart animation
	    chart.animation(true);

	    // set chart padding
	    chart.padding([10, 20, 5, 20]);

	    // turn on the crosshair
	    chart.crosshair()
	            .enabled(true)
	            .yLabel(false)
	            .yStroke(null);

	    // set tooltip mode to point
	    chart.tooltip().positionMode('point');

	    // set chart title text settings
	    chart.title('NET CASH FLOW');
	    chart.title().padding([0, 0, 5, 0]);

	    // set yAxis title
	    chart.yAxis().title('AMOUNT');
	    chart.xAxis().labels().padding([5]);

	    // create first series with mapped data
	    var series_1 = chart.line(seriesData_1);
	    series_1.name('Cash Flow');
	    series_1.hoverMarkers()
	            .enabled(true)
	            .type('circle')
	            .size(4);
	    series_1.tooltip()
	            .position('right')
	            .anchor('left')
	            .offsetX(5)
	            .offsetY(5);

	    // create second series with mapped data
	    var series_2 = chart.line(seriesData_2);
	    series_2.name('Default')
	    .stroke('black');;


	    // turn the legend on
	    chart.legend()
	            .enabled(true)
	            .fontSize(13)
	            .padding([0, 0, 10, 0]);

	    // set container id for the chart and set up paddings
	    chart.container('netCashFlow');

	    // initiate chart drawing
	    chart.draw();
		
	}
	
	
	function cumulativeCashFlow(){
		
		$("#cumulativeCashFlow").empty();
		
		// create data set on our data
	    var dataSet = anychart.data.set(getDataCumulativeCashFlow());

	    // map data for the first series, take x from the zero column and value from the first column of data set
	    var seriesData_1 = dataSet.mapAs({x: [0], value: [1]});

	    // map data for the second series, take x from the zero column and value from the second column of data set
	    var seriesData_2 = dataSet.mapAs({x: [0], value: [2]});

	    // map data for the third series, take x from the zero column and value from the third column of data set
	    var seriesData_3 = dataSet.mapAs({x: [0], value: [3]});

	    // create line chart
	    chart = anychart.line();

	    // turn on chart animation
	    chart.animation(true);

	    // set chart padding
	    chart.padding([10, 20, 5, 20]);

	    // turn on the crosshair
	    chart.crosshair()
	            .enabled(true)
	            .yLabel(false)
	            .yStroke(null);

	    // set tooltip mode to point
	    chart.tooltip().positionMode('point');

	    // set chart title text settings
	    chart.title('CUMULATIVE CASH FLOW');
	    chart.title().padding([0, 0, 5, 0]);

	    // set yAxis title
	    chart.yAxis().title('AMOUNT');
	    chart.xAxis().labels().padding([5]);

	    // create first series with mapped data
	    var series_1 = chart.line(seriesData_1);
	    series_1.name('Cash Flow')
	    			.stroke('orange');;
	    series_1.hoverMarkers()
	            .enabled(true)
	            .type('circle')
	            .size(4);
	    series_1.tooltip()
	            .position('right')
	            .anchor('left')
	            .offsetX(5)
	            .offsetY(5);

	    // create second series with mapped data
	    var series_2 = chart.line(seriesData_2);
	    series_2.name('Default')
	    .stroke('black');;


	    // turn the legend on
	    chart.legend()
	            .enabled(true)
	            .fontSize(13)
	            .padding([0, 0, 10, 0]);

	    // set container id for the chart and set up paddings
	    chart.container('cumulativeCashFlow');

	    // initiate chart drawing
	    chart.draw();
	   
		
	}
	
	
	function getDataNetCashFlow() {
		var B53_2 = Number($("#B53_2").val().replace(/,/g , ''));
		
		
	    return [
	    	    [year[0],net[0],'0'],
	    		[year[1],net[1],'0'],
	    		[year[2],net[2],'0'],
	    		[year[3],net[3],'0'],
	    		[year[4],net[4],'0'],
	    		[year[5],net[5],'0'],
	    		[year[6],net[6],'0'],
	    		[year[7],net[7],'0'],
	    		[year[8],net[8],'0'],
	    		[year[9],net[9],'0'],
	    		[year[10],net[10],'0'],
	    		[year[11],net[11],'0'],
	    		[year[12],net[12],'0'],
	    		[year[13],net[13],'0'],
	    		[year[14],net[14],'0'],
	    		[year[15],net[15],'0'],
	    		[year[16],net[16],'0'],
	    		[year[17],net[17],'0'],
	    		[year[18],net[18],'0'],
	    		[year[19],net[19],'0'],
	    		[year[20],net[20],'0']
	    	 ]
	}
	
	
	function getDataCumulativeCashFlow() {
	    return [
	    		[year[0],cumulative[0],'0'],	
	    		[year[1],cumulative[1],'0'],
	    		[year[2],cumulative[2],'0'],
	    		[year[3],cumulative[3],'0'],
	    		[year[4],cumulative[4],'0'],
	    		[year[5],cumulative[5],'0'],
	    		[year[6],cumulative[6],'0'],
	    		[year[7],cumulative[7],'0'],
	    		[year[8],cumulative[8],'0'],
	    		[year[9],cumulative[9],'0'],
	    		[year[10],cumulative[10],'0'],
	    		[year[11],cumulative[11],'0'],
	    		[year[12],cumulative[12],'0'],
	    		[year[13],cumulative[13],'0'],
	    		[year[14],cumulative[14],'0'],
	    		[year[15],cumulative[15],'0'],
	    		[year[16],cumulative[16],'0'],
	    		[year[17],cumulative[17],'0'],
	    		[year[18],cumulative[18],'0'],
	    		[year[19],cumulative[19],'0'],
	    		[year[20],cumulative[20],'0']
	    ]
	}
	
	
	
	
	</script>

</body>
</html>